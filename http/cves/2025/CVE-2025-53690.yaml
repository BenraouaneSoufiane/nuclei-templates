id: sitecore-viewstate-cve-2025-53690
info:
  name: Sitecore ViewState Deserialization (CVE-2025-53690)
  author: your-handle
  severity: critical
  description: Detects acceptance of a ViewState signed with the known sample machineKey.
  reference:
    - https://cloud.google.com/blog/topics/threat-intelligence/viewstate-deserialization-zero-day-vulnerability
http:
  - method: GET
    path:
      - "{{BaseURL}}/sitecore/blocked.aspx"
    matchers:
      - type: word
        words: ["__VIEWSTATE"]
  - method: POST
    path:
      - "{{BaseURL}}/sitecore/blocked.aspx"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "__VIEWSTATE=<BASE64_GOOD>&__VIEWSTATEGENERATOR=<GEN_IF_NEEDED>"
    matchers-condition: and
    matchers:
      - type: status
        status: [200]
      - type: word
        words:
          - "EXPECTED_MARKER_OR_ERROR_TEXT"
        part: body
      - type: negative_word
        words:
          - "Viewstate verification failed"
        part: body
  - method: POST
    path:
      - "{{BaseURL}}/sitecore/blocked.aspx"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "__VIEWSTATE=<BASE64_BAD_SIG>"
    matchers:
      - type: word
        words: ["Viewstate verification failed"]
        part: body
    extractors:
      - type: kval
        name: evidence
        internal: true
