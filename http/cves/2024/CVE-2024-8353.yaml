id: cve-2024-8353-givewp-poi

info:
  name: GiveWP <= 3.16.1 â€“ Insecure Deserialization (CVE-2024-8353)
  author: BenraouaneSoufiane
  severity: critical
  description: >
    Detects deserialization of untrusted input during the donation flow by
    submitting a harmless serialized scalar to a known form field and
    observing vulnerable vs. fixed behavior.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-8353
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/give/givewp-donation-plugin-and-fundraising-platform-3161-unauthenticated-php-object-injection
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/wp_givewp_rce.rb
  tags: cve,wordpress,givewp,deserialization,poi

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
      Accept: "*/*"
    body: |
      action=give_process_donation&
      give_form_id=9&
      give_title=i%3A1%3B&
      card_address=i%3A1%3B
    max-redirects: 2
    redirects: true
    matchers-condition: or
    matchers:
      # Sites with display_errors on (dev/staging) may leak this:
      - type: word
        part: body
        words:
          - "unserialize():"
          - "PHP Fatal error"
        condition: or
      # Behavioral oracle: vulnerable builds often return 200 with JSON indicating the
      # field passed deeper than expected, while fixed builds reject/normalize.
      - type: status
        status: [200]
        condition: and
      # Optional: look for typical GiveWP AJAX response keys when it shouldn't accept serialized input
      - type: regex
        part: body
        regex:
          - "(?i)givewp|donation|form|error"
